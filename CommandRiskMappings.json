/*
  2019-04-17

  Mappings used to determine what risks specific commands have.
  Current format is the following:
  [
    {
      Command: Case-sensitive command name (required)
      BaseRisk: floating number of risk (required)
      RiskQueries: array of criterias for highten risk value (optional)
        [
          {
            Type: lower-case identifier of type of comparison, available types are "regex" (required)
            Value: 
          }
        ]
    }
  ]
*/
[
  {
    "Command": "Get-LocalGroup",
    "BaseRisk": 2
  },
  {
    "Command": "Get-LocalGroupMember",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "-Name[ \"]*(A|a)dmin",
        "Location": "parameter",
        "RiskAddition": 4
      }
    ]
  },
  {
    "Command": "Get-ChildItem",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "-Path.*\\\\Start Menu\\\\Programs\\\\Startup",
        "Location": "parameter",
        "RiskAddition": 4
      },
      {
        "Type": "regex",
        "Value": "-Path.*C:\\\\Users$",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "-Include.*web.config",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "-Path.*Program Files",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "-Path.*Registry::.*Software",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "-Path.*Startup",
        "Location": "parameter",
        "RiskAddition": 2
      }
    ]
  },
  {
    "Command": "Add-Type",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "-AssemblyName.*System.Security",
        "Location": "parameter",
        "RiskAddition": 8
      }
    ]
  },
  {
    "Command": "Get-WmiObject",
    "BaseRisk": 0,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "Win32_Product",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "Win32_Process",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "Win32_Service",
        "Location": "parameter",
        "RiskAddition": 6
      }
    ]
  },
  {
    "Command": "Set-ExecutionPolicy",
    "BaseRisk": 0,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "-ExecutionPolicy.*Bypass",
        "Location": "parameter",
        "RiskAddition": 8
      },
      {
        "Type": "regex",
        "Value": "-ExecutionPolicy.*Unrestricted",
        "Location": "parameter",
        "RiskAddition": 5
      }
    ]
  },
  {
    "Command": "Get-Service",
    "BaseRisk": 4
  },
  {
    "Command": "Get-ScheduledTask",
    "BaseRisk": 4
  },
  {
    "Command": "Get-PSDrive",
    "BaseRisk": 4
  },
  {
    "Command": "Select-String",
    "BaseRisk": 0,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^-Path.*Firefox\\\\Profiles",
        "Location": "parameter",
        "RiskAddition": 10
      },
      {
        "Type": "regex",
        "Value": "-Path.*Chrome\\\\User Data",
        "Location": "parameter",
        "RiskAddition": 10
      }
    ]
  },
  {
    "Command": "Invoke-WebRequest",
    "BaseRisk": 20,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^-UseDefaultCredentials",
        "Location": "parameter",
        "RiskAddition": 30
      }
    ]
  },
  {
    "Command": "New-Object",
    "BaseRisk": 0,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^-ArgumentList.*Chrome\\\\User Data",
        "Location": "parameter",
        "RiskAddition": 10
      },
      {
        "Type": "regex",
        "Value": "^-TypeName.*Windows.Security.Credentials.PasswordVault",
        "Location": "parameter",
        "RiskAddition": 50
      },
      {
        "Type": "regex",
        "Value": "^-TypeName.*System.Net.Networkinformation.Ping",
        "Location": "parameter",
        "RiskAddition": 10
      },
      {
        "Type": "regex",
        "Value": "^-TypeName.*System.Net.Sockets.TcpClient",
        "Location": "parameter",
        "RiskAddition": 10
      },
      {
        "Type": "regex",
        "Value": [ "^-TypeName.*System.DirectoryServices.DirectoryEntry", "^-ArgumentList.*LDAP://" ],
        "Location": "parameter",
        "RiskAddition": 10
      }
    ]
  },
  {
    "Command": "Enter-PSSession",
    "BaseRisk": 50
  },
  {
    "Command": "systeminfo",
    "BaseRisk": 2
  },
  {
    "Command": "ipconfig",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^/all$",
        "Location": "parameter",
        "RiskAddition": 4
      }
    ]
  },
  {
    "Command": "reg",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "query",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "password",
        "Location": "parameter",
        "RiskAddition": 4
      },
      {
        "Type": "regex",
        "Value": "PowerShellVersion",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "Windows.*Run",
        "Location": "parameter",
        "RiskAddition": 4
      },
      {
        "Type": "regex",
        "Value": "AlwaysInstallElevated",
        "Location": "parameter",
        "RiskAddition": 18
      },
      {
        "Type": "regex",
        "Value": "Terminal Server Client",
        "Location": "parameter",
        "RiskAddition": 8
      }
    ]
  },
  {
    "Command": "net",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^user$",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "^accounts$",
        "Location": "parameter",
        "RiskAddition": 4
      },
      {
        "Type": "regex",
        "Value": "^Administrat(o|ö)r$",
        "Location": "parameter",
        "RiskAddition": 4
      },
      {
        "Type": "regex",
        "Value": "^start$",
        "Location": "parameter",
        "RiskAddition": 4
      }
    ]
  },
  {
    "Command": "whoami",
    "BaseRisk": 1,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^/all$",
        "Location": "parameter",
        "RiskAddition": 5
      }
    ]
  },
  {
    "Command": "findstr",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^/.*s",
        "Location": "parameter",
        "RiskAddition": 4
      },
      {
        "Type": "regex",
        "Value": "^/.*i",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "^password$",
        "Location": "parameter",
        "RiskAddition": 6
      },
      {
        "Type": "regex",
        "Value": "system32",
        "Location": "parameter",
        "RiskAddition": 3
      },
      {
        "Type": "regex",
        "Value": "binary_path_name",
        "Location": "parameter",
        "RiskAddition": 4
      },
      {
        "Type": "regex",
        "Value": "service_name",
        "Location": "parameter",
        "RiskAddition": 4
      }
    ]
  },
  {
    "Command": "dir",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "pass",
        "Location": "parameter",
        "RiskAddition": 3
      },
      {
        "Type": "regex",
        "Value": "cred",
        "Location": "parameter",
        "RiskAddition": 3
      },
      {
        "Type": "regex",
        "Value": "config",
        "Location": "parameter",
        "RiskAddition": 3
      }
    ]
  },
  {
    "Command": "tasklist",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "eq system",
        "Location": "parameter",
        "RiskAddition": 2
      }
    ]
  },
  {
    "Command": "sc",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^query$",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "^qc$",
        "Location": "parameter",
        "RiskAddition": 6
      }
    ]
  },
  {
    "Command": "wmic",
    "BaseRisk": 2,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^service$",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "^startup$",
        "Location": "parameter",
        "RiskAddition": 2
      }
    ]
  },
  {
    "Command": "schtasks",
    "BaseRisk": 0,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^/query$",
        "Location": "parameter",
        "RiskAddition": 2
      },
      {
        "Type": "regex",
        "Value": "^/create$",
        "Location": "parameter",
        "RiskAddition": 50
      }
    ]
  },
  {
    "Command": "icacls",
    "BaseRisk": 10
  },
  {
    "Command": "nslookup",
    "BaseRisk": 0,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^172\\.(1[6-9]|2[0-9]|3[01])|^10\\.|^192\\.168\\.",
        "Location": "parameter",
        "RiskAddition": 1
      }
    ]
  },
  {
    "Command": "ping",
    "BaseRisk": 0,
    "RiskQueries": [
      {
        "Type": "regex",
        "Value": "^172\\.(1[6-9]|2[0-9]|3[01])|^10\\.|^192\\.168\\.",
        "Location": "parameter",
        "RiskAddition": 1
      }
    ]
  }
]
